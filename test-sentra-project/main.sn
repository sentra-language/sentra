#!/usr/bin/env sentra
// Example security scanner using Sentra

log("üîí Sentra Security Scanner v1.0")
log("=================================")

// Basic system information
let sys = os_info()
log("Platform: " + sys["platform"])
log("Hostname: " + sys["hostname"])

// Check running privileges
if (os_privileges()) {
    log("‚ö†Ô∏è  Running with elevated privileges")
} else {
    log("‚úì Running with standard privileges")
}

// Port scan example
log("\nüîç Scanning localhost...")
let results = port_scan("127.0.0.1", 80, 85, "TCP")

let openPortCount = 0
for (let i = 0; i < len(results); i++) {
    let port = results[i]
    if (port["state"] == "open") {
        log("‚úì Port " + port["port"] + " is open")
        // Note: variable mutation may need different syntax
    }
}

log("\nüìä Scan Results:")
log("Total ports scanned: " + str(len(results)))
log("Open ports found: " + str(openPortCount))

// File integrity check
log("\nüìÅ File Integrity Check...")
if (fs_create_baseline(".", false)) {
    log("‚úì Baseline created for current directory")
}

log("\n‚úÖ Security scan completed!")