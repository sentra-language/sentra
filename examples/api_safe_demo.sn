// Safe API Security Demo
log("ðŸ”’ Sentra API Security Testing")

let endpoint = "https://httpbin.org/get"
log("Testing: " + endpoint)

log("\nðŸ“Š Results:")

// Test headers
let headers = test_headers(endpoint)
log("â€¢ Security headers score: " + headers["score"] + "%")

// Test CORS  
let cors = test_cors(endpoint, "http://evil.com")
log("â€¢ CORS vulnerable: " + cors["vulnerable"])

// Test rate limiting
let rate = test_rate_limiting(endpoint, 3, 1)
log("â€¢ Rate limiting: " + rate["has_rate_limit"])

log("\nâœ… API security functions working!")
log("ðŸŽ¯ Ready for production security testing!")