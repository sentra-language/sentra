// src/config.sn - Configuration module

// Export: Default scan configuration
fn GetDefaultConfig() {
    return {
        "timeout": 2000,
        "retries": 3,
        "verbose": true,
        "max_threads": 10,
        "port_ranges": {
            "common": [21, 22, 23, 25, 80, 443, 3306, 3389, 8080],
            "web": [80, 443, 8080, 8443],
            "database": [1433, 3306, 5432, 27017],
            "remote": [22, 23, 3389, 5900]
        }
    }
}

// Export: Get port range by category
fn GetPortRange(category) {
    let config = GetDefaultConfig()
    let ranges = config["port_ranges"]
    
    if category == "common" {
        return ranges["common"]
    }
    if category == "web" {
        return ranges["web"]
    }
    if category == "database" {
        return ranges["database"]
    }
    if category == "remote" {
        return ranges["remote"]
    }
    
    // Return common ports as default
    return ranges["common"]
}

// Export: Validate configuration
fn ValidateConfig(config) {
    let errors = []
    
    // Check timeout
    if config["timeout"] < 100 {
        push(errors, "Timeout too low (min: 100ms)")
    }
    if config["timeout"] > 30000 {
        push(errors, "Timeout too high (max: 30s)")
    }
    
    // Check threads
    if config["max_threads"] < 1 {
        push(errors, "At least 1 thread required")
    }
    if config["max_threads"] > 100 {
        push(errors, "Too many threads (max: 100)")
    }
    
    return errors
}