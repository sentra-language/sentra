#!/usr/bin/env sentra
// Main entry point - Security scanner application

import "./src/scanner.sn"
import "./src/reporter.sn"
import "./src/utils.sn"

fn main() {
    log("=== Security Scanner v1.0 ===")
    log("")
    
    // Define targets to scan
    let targets = [
        "192.168.1.1",
        "192.168.1.100",
        "10.0.0.1"
    ]
    
    // Scan each target
    let allResults = []
    for target in targets {
        log("Scanning target: " + target)
        
        // Check if it's a private IP
        if IsPrivateIP(target) {
            log("  Note: This is a private IP address")
        }
        
        // Scan common ports
        let openPorts = ScanPorts(target, 80, 443)
        
        // Detect services on open ports
        let services = []
        for port in openPorts {
            let service = DetectService(target, port)
            push(services, {
                "port": port,
                "service": service
            })
        }
        
        // Store result
        let result = {
            "host": target,
            "ports": openPorts,
            "services": services
        }
        push(allResults, result)
    }
    
    // Generate report
    log("")
    log("Generating report...")
    let report = CreateReport(allResults)
    let reportText = FormatReportText(report)
    
    // Display report
    log("")
    log(reportText)
    
    // Save report to file (simulated)
    log("")
    log("Report saved to: security_scan_report.txt")
    
    return 0
}

// Run the main function
main()
